@startuml

class CommunicationException

class Communicator

class DataContainer {
  +dataId : String
  +data : Object
}

class MapDataContainer {
  +getData() : Map<String, Object>
}

interface ICommunicatorAccess {
  +{abstract}send(String hostname, DataContainer data) : Future<DataContainer>
  ~{abstract}forward(String hostname, String message) : String
}

interface IDataAcceptance {
  +{abstract}evaluateData(String hostAddress, DataContainer data) : Future<DataContainer>
}

interface ISender {
  +{abstract}send(String address, MessageContainer message) : MessageContainer
}

class MessageContainer {
  +interpreter : String
  +message : String
  +toString() : String
}

abstract class AbstractReceiver {
  +{abstract}getAddress() : String
  +setInterpreterManager(InterpreterManager interpreter)
  +dispose()
}

class SenderManager {
  -senderPool : ExecutorService
  -{static}THREAD_COUNT : int
  +setSender(Map<String, ISender> sender)
  +init()
  +dispose()
  ~send(String address, MessageContainer message, String protocol) : Future<MessageContainer>
}

interface IInterpreter {
  +{abstract}decode(String message) : DataContainer
  +{abstract}encode(DataContainer data) : String
  +{abstract}interpret(String message, String sender, IDataAcceptance acceptance, INodeRegistration nr) : String
}

class InterpreterManager {
  -interpreterPool : ExecutorService
  -{static}THREAD_COUNT : int
  +setInterpreter(Map<String, IInterpreter> cis)
  +setDataAcceptance(IDataAcceptance acceptance)
  +setNodeRegistration(INodeRegistration nr)
  +encode(DataContainer data, String type) : Future<String>
  +decode(String message, String type) : Future<DataContainer>
  +interpret(MessageContainer msgContainer, String sender) : Future<String>
  +getInterpreterIds() : Set<String>
}

class Encoder {
  +call() : String
}

class Decoder {
  +call() : DataContainer
}

class Interpreter {
  +call() : String
}

class Sender {
  +call() : MessageContainer
}

interface IClientRegistration

interface INodeRegistration


DataContainer <|.. MapDataContainer
ICommunicatorAccess <|.. Communicator


AbstractReceiver o-- "interpreter" InterpreterManager

Communicator o-- "im" InterpreterManager

InterpreterManager ..> Encoder : <<use>>
InterpreterManager ..> Decoder : <<use>>
InterpreterManager ..> Interpreter : <<use>>
InterpreterManager o-- "nr" INodeRegistration
InterpreterManager *-- "0..*\ninterpreter" IInterpreter
InterpreterManager o-- "dataAcceptance" IDataAcceptance

IInterpreter ..> IDataAcceptance : <<use>>
IInterpreter ..> INodeRegistration : <<use>>

Encoder ..> IInterpreter : <<use>>
Decoder ..> IInterpreter : <<use>>
Interpreter ..> IInterpreter : <<use>>

SenderManager *-- "0..*\nsender" ISender
SenderManager ..> Sender : <<use>>

Sender ..> ISender : <<use>>

@enduml